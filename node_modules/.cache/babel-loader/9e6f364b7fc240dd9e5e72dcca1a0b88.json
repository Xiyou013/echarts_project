{"ast":null,"code":"import { onMounted, reactive, ref, toRefs, watch } from \"@vue/runtime-core\";\nexport default {\n  __name: 'addDialog',\n  props: {\n    dialogVisible: {\n      type: Object,\n      default: () => {}\n    },\n    isEdit: {\n      type: Object,\n      default: () => {}\n    },\n    id: {\n      type: Number,\n      default: 9\n    }\n  },\n\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const props = __props;\n    let state = reactive(store.state.Original_god);\n    console.log(state.list);\n    const rules = {\n      name: [{\n        required: true,\n        message: \"请输入姓名\"\n      }],\n      type: [{\n        required: true,\n        message: \"请选择属性\"\n      }]\n    };\n    const formRef = ref(null);\n    let dialogFormVisible = reactive({\n      dialogFormVisible: false\n    });\n    let form = reactive({\n      form: {\n        name: \"\",\n        type: \"\"\n      }\n    });\n    let attributeList = attribute;\n    onMounted(() => {\n      console.log(\"---isEdit---\", props.isEdit.isEdit); // console.log('---id---',props.id)\n    }); // console.log(\"---props---\", props.dialogVisible);\n\n    watch(props.dialogVisible, (newValue, oldValue) => {\n      // console.log(\"---dialogVisible---\", newValue, oldValue);\n      dialogFormVisible.dialogFormVisible = newValue.dialogFormVisible; // console.log(\"---dialogFormVisible---\", dialogFormVisible);\n\n      if (newValue || oldValue) return;\n    });\n    watch([() => props.id, props.isEdit], (newValue, oldValue) => {\n      console.log(\"---id and isEdit---\", newValue, oldValue);\n      console.log(\"---newValue1111111---\", newValue[1].isEdit, form.form);\n\n      if (newValue[1].isEdit) {\n        getRowData(props.id);\n        console.log(\"---form---\", form);\n      } else {\n        form.form = {\n          name: \"\",\n          type: \"\"\n        };\n        console.log(\"---newValue2222222---\", newValue[1].isEdit, form.form);\n      }\n\n      if (newValue || oldValue) return;\n    });\n\n    function Cancel() {\n      dialogFormVisible.dialogFormVisible = false;\n\n      if (!props.isEdit.isEdit) {\n        console.log(\"---!isEdit1111---\", !props.isEdit.isEdit);\n        form.form = {\n          name: \"\",\n          type: \"\"\n        };\n        formRef.value.resetFields(); // form.form = {}\n      } else {\n        console.log(\"---!changeDialog11111---\", !props.isEdit.isEdit);\n        context.emit(\"changeIsEdit\", !props.isEdit.isEdit);\n      }\n\n      context.emit(\"changeDialog\");\n    }\n\n    function Confirm() {\n      formRef.value.validate(valid => {\n        if (valid) {\n          console.log(\"Confirm\", !props.isEdit.isEdit);\n\n          if (!props.isEdit.isEdit) {\n            addData();\n          } else {\n            editData();\n          }\n        }\n      });\n    }\n\n    function addData() {\n      let personList = state.list; // console.log('---form and personList---',form,personList,personList.length);\n\n      personList.push({\n        id: personList.length + 1,\n        ...form.form\n      }); // console.log('---personList---',personList,personList.length);\n\n      store.commit(\"changeList\", personList);\n      console.log(\"---count---\", state.list);\n      dialogFormVisible.dialogFormVisible = false;\n      context.emit(\"changeDialog\", false);\n      formRef.value.resetFields();\n    }\n\n    function editData() {\n      console.log(\"---id and from ---\", props.id, form.form);\n      let personList = state.list;\n      let index = personList.map(item => item.id).indexOf(props.id);\n      console.log(\"---form and personList---\", form, personList, props.id, index);\n      personList.splice(index, 1, form.form); // console.log('---personList---',personList,personList.length);\n\n      store.commit(\"changeList\", personList); // console.log(\"---count---\", state.list);\n\n      dialogFormVisible.dialogFormVisible = false;\n      context.emit(\"changeDialog\", false);\n    }\n\n    function getRowData(id) {\n      let personList = state.list;\n      let formData = personList.filter(item => {\n        return item.id === id;\n      });\n      form.form = { ...formData[0]\n      };\n      console.log(\"---form111111---\", form);\n    }\n\n    const __returned__ = {\n      props,\n      state,\n      rules,\n      formRef,\n      dialogFormVisible,\n      form,\n      attributeList,\n      Cancel,\n      Confirm,\n      addData,\n      editData,\n      getRowData,\n      onMounted,\n      reactive,\n      ref,\n      toRefs,\n      watch\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["onMounted","reactive","ref","toRefs","watch","state","store","Original_god","console","log","list","rules","name","required","message","type","formRef","dialogFormVisible","form","attributeList","attribute","props","isEdit","dialogVisible","newValue","oldValue","id","getRowData","Cancel","value","resetFields","context","emit","Confirm","validate","valid","addData","editData","personList","push","length","commit","index","map","item","indexOf","splice","formData","filter"],"sources":["F:/hub-code/echarts_project/src/components/addDialog.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog\r\n      v-model=\"dialogFormVisible.dialogFormVisible\"\r\n      :title=\"isEdit.isEdit ? `编辑人物信息` : `新增人物信息`\"\r\n      modal\r\n      :close-on-click-modal=\"false\"\r\n      :before-close=\"Cancel\"\r\n    >\r\n      <el-form :model=\"form\" label-suffix=\":\" :rules=\"rules\" ref=\"formRef\">\r\n        <el-form-item label=\"姓名\" label-width=\"150px\" prop=\"name\">\r\n          <el-input\r\n            v-model=\"form.name\"\r\n            placeholder=\"请输入姓名\"\r\n            style=\"width: 250px\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item label=\"属性\" label-width=\"150px\" prop=\"type\">\r\n          <el-select\r\n            v-model=\"form.type\"\r\n            placeholder=\"请选择属性\"\r\n            style=\"width: 250px\"\r\n          >\r\n            <el-option\r\n              v-for=\"(item, index) in attributeList\"\r\n              :key=\"index\"\r\n              :label=\"item.name\"\r\n              :value=\"item.type\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n      </el-form>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"Cancel\">取消</el-button>\r\n          <el-button type=\"primary\" @click=\"Confirm\">确定</el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, ref, toRefs, watch } from \"@vue/runtime-core\";\r\n\r\n\r\nconst props = defineProps({\r\n  dialogVisible: {\r\n    type: Object,\r\n    default: () => { },\r\n  },\r\n  isEdit: {\r\n    type: Object,\r\n    default: () => { },\r\n  },\r\n  id: {\r\n    type: Number,\r\n    default: 9,\r\n  },\r\n})\r\n\r\n    let state = reactive(store.state.Original_god);\r\n    console.log(state.list);\r\n\r\n    const rules = {\r\n      name: [{ required: true, message: \"请输入姓名\" }],\r\n      type: [{ required: true, message: \"请选择属性\" }],\r\n    };\r\n    const formRef = ref(null);\r\n\r\n    let dialogFormVisible = reactive({\r\n      dialogFormVisible: false,\r\n    });\r\n    let form = reactive({\r\n      form: {\r\n        name: \"\",\r\n        type: \"\",\r\n      },\r\n    });\r\n    let attributeList = attribute;\r\n    onMounted(() => {\r\n      console.log(\"---isEdit---\", props.isEdit.isEdit);\r\n      // console.log('---id---',props.id)\r\n    });\r\n\r\n    // console.log(\"---props---\", props.dialogVisible);\r\n    watch(props.dialogVisible, (newValue, oldValue) => {\r\n      // console.log(\"---dialogVisible---\", newValue, oldValue);\r\n      dialogFormVisible.dialogFormVisible = newValue.dialogFormVisible;\r\n      // console.log(\"---dialogFormVisible---\", dialogFormVisible);\r\n      if (newValue || oldValue) return;\r\n    });\r\n    watch([() => props.id, props.isEdit], (newValue, oldValue) => {\r\n      console.log(\"---id and isEdit---\", newValue, oldValue);\r\n      console.log(\"---newValue1111111---\", newValue[1].isEdit, form.form);\r\n\r\n      if (newValue[1].isEdit) {\r\n        getRowData(props.id);\r\n        console.log(\"---form---\", form);\r\n      } else {\r\n        form.form = { name: \"\", type: \"\" };\r\n        console.log(\"---newValue2222222---\", newValue[1].isEdit, form.form);\r\n      }\r\n      if (newValue || oldValue) return;\r\n    });\r\n    function Cancel() {\r\n      dialogFormVisible.dialogFormVisible = false;\r\n      if (!props.isEdit.isEdit) {\r\n        console.log(\"---!isEdit1111---\", !props.isEdit.isEdit);\r\n        form.form = { name: \"\", type: \"\" };\r\n\r\n        formRef.value.resetFields();\r\n        // form.form = {}\r\n      } else {\r\n        console.log(\"---!changeDialog11111---\", !props.isEdit.isEdit);\r\n        context.emit(\"changeIsEdit\",!props.isEdit.isEdit);\r\n      }\r\n      context.emit(\"changeDialog\");\r\n    }\r\n    function Confirm() {\r\n      formRef.value.validate((valid) => {\r\n        if (valid) {\r\n          console.log(\"Confirm\", !props.isEdit.isEdit);\r\n          if (!props.isEdit.isEdit) {\r\n            addData();\r\n          } else {\r\n            editData();\r\n          }\r\n        }\r\n      });\r\n    }\r\n    function addData() {\r\n      let personList = state.list;\r\n      // console.log('---form and personList---',form,personList,personList.length);\r\n      personList.push({ id: personList.length + 1, ...form.form });\r\n      // console.log('---personList---',personList,personList.length);\r\n      store.commit(\"changeList\", personList);\r\n      console.log(\"---count---\", state.list);\r\n      dialogFormVisible.dialogFormVisible = false;\r\n      context.emit(\"changeDialog\", false);\r\n      formRef.value.resetFields();\r\n    }\r\n    function editData() {\r\n      console.log(\"---id and from ---\", props.id, form.form);\r\n      let personList = state.list;\r\n      let index = personList.map((item) => item.id).indexOf(props.id);\r\n      console.log(\r\n        \"---form and personList---\",\r\n        form,\r\n        personList,\r\n        props.id,\r\n        index\r\n      );\r\n      personList.splice(index, 1, form.form);\r\n      // console.log('---personList---',personList,personList.length);\r\n      store.commit(\"changeList\", personList);\r\n      // console.log(\"---count---\", state.list);\r\n      dialogFormVisible.dialogFormVisible = false;\r\n      context.emit(\"changeDialog\", false);\r\n    }\r\n    function getRowData(id) {\r\n      let personList = state.list;\r\n      let formData = personList.filter((item) => {\r\n        return item.id === id;\r\n      });\r\n      form.form = { ...formData[0] };\r\n      console.log(\"---form111111---\", form);\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n</style>"]},"metadata":{},"sourceType":"module"}